const fs = require('fs')
const path = require('path')

const sqlFile = path.join(__dirname, '../prisma/migrations/fix-client-rls-policies.sql')
const sql = fs.readFileSync(sqlFile, 'utf8')

console.log('='.repeat(80))
console.log('SQL MIGRATION: Fix Client RLS Policies')
console.log('='.repeat(80))
console.log('')
console.log('Copy and paste the following SQL into Supabase SQL Editor:')
console.log('')
console.log('-'.repeat(80))
console.log(sql)
console.log('-'.repeat(80))
console.log('')
console.log('This will:')
console.log('1. Check current RLS status on Client table')
console.log('2. Create policies to allow service_role full access (for your Next.js API)')
console.log('3. Optionally create policies for authenticated users (if using Supabase Auth)')
console.log('4. Verify that policies were created correctly')
console.log('')
console.log('After running this migration, try saving your invoice information again.')

